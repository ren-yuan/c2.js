!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).c2=t()}(function(){return function i(n,r,h){function o(e,t){if(!r[e]){if(!n[e]){var s="function"==typeof require&&require;if(!t&&s)return s(e,!0);if(a)return a(e,!0);throw(s=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",s}s=r[e]={exports:{}},n[e][0].call(s.exports,function(t){return o(n[e][1][t]||t)},s,s.exports,i,n,r,h)}return r[e].exports}for(var a="function"==typeof require&&require,t=0;t<h.length;t++)o(h[t]);return o}({1:[function(t,e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Analyser=s.Sound=s.AudioIn=void 0;let i;function n(){"undefined"!=typeof window&&void 0===i&&(window.AudioContext=window.AudioContext||window.webkitAudioContext,i=new AudioContext)}s.AudioIn=class{constructor(e){n(),this.context=i;window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(t=>{this.node=i.createMediaStreamSource(t),e()}).catch(t=>{})}connect(t){this.node.connect(t)}disconnect(){this.node.disconnect()}};s.Sound=class{constructor(t,e){n(),this.context=i,this.audio=new Audio(t),this.audio.addEventListener("loadeddata",()=>{this.node=i.createMediaElementSource(this.audio),e()})}duration(){return this.audio.duration}currentTime(){return this.audio.currentTime}volume(){return this.audio.volume}paused(){return this.audio.paused}loop(t=!0){this.audio.loop=t}autoplay(t=!0){this.audio.autoplay=t}play(){this.audio.play()}pause(){this.audio.pause()}connect(t){this.node.connect(t)}disconnect(){this.node.disconnect()}};s.Analyser=class{constructor(){n(),this.context=i,this.node=i.createAnalyser()}analyze(t){t.node.connect(this.node)}fftSize(t){this.node.fftSize=t}binCount(){return this.node.frequencyBinCount}smooth(t){this.node.smoothingTimeConstant=t}level(){var e=this.timeDomain();let s=0;for(let t=0;t<e.length;t++)s+=e[t]*e[t];return s/=e.length,Math.sqrt(s)}timeDomain(){var e=new Uint8Array(this.node.frequencyBinCount);this.node.getByteTimeDomainData(e);let s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=(e[t]-128)/128;return s}freqDomain(){var e=new Uint8Array(this.node.frequencyBinCount);this.node.getByteFrequencyData(e);let s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=e[t]/255;return s}connect(t){this.node.connect(t)}disconnect(){this.node.disconnect()}output(){this.node.connect(i.destination)}}},{}],2:[function(t,e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Neuron=s.NeuralNet=s.Mutation=s.Crossover=s.Chromosome=s.Population=void 0;s.Population=class{constructor(t,e,s,i){this._selection="roulette",this._sumFitness=0,this._tournament=0,this._elitism=0,this.chromosomes=t,this.crossoverRate=e,this.mutationRate=s,this.generation=0,this._fitness=i}setElitism(t){this._elitism=t}setSelection(t,e=0){this._selection=t,this._tournament=e}setCrossover(t){for(var e of this.chromosomes)e.setCrossover(t)}setMutation(t){for(var e of this.chromosomes)e.setMutation(t)}fitness(){this._sumFitness=0;for(var t of this.chromosomes)this._fitness&&this._fitness(t),this._sumFitness+=t.fitness;return this.chromosomes.sort((t,e)=>e.fitness-t.fitness),{generation:this.generation,sumFitness:this._sumFitness,averageFitness:this._sumFitness/this.chromosomes.length,bestFitness:this.chromosomes[0].fitness,worstFitness:this.chromosomes[this.chromosomes.length-1].fitness,bestChromosome:this.chromosomes[0]}}reproduction(){let e=new Array;if(0<this._elitism&&this._elitism<=this.chromosomes.length)for(let t=0;t<this._elitism;t++)e.push(this.chromosomes[t].copy());for(;e.length<this.chromosomes.length;){var s=this.selection(),i=this.selection();let t=this.crossover(s,i);t instanceof Array?(t[0].mutation(this.mutationRate),e.push(t[0]),e.length<this.chromosomes.length&&2==t.length&&(t[1].mutation(this.mutationRate),e.push(t[1]))):(t.mutation(this.mutationRate),e.push(t))}this.chromosomes=e,this.generation++}selection(){return"roulette"==this._selection?this.roulette():"tournament"==this._selection?this.tournament():void 0}roulette(){let t=0;var e,s=Math.random()*this._sumFitness;for(e of this.chromosomes)if(t+=e.fitness,t>=s)return e}tournament(){let e=Number.NEGATIVE_INFINITY,s=null;for(let t=0;t<this._tournament;t++){var i=Math.floor(Math.random()*this.chromosomes.length),i=this.chromosomes[i];(i.fitness>e||null==s)&&(e=i.fitness,s=i)}return s}crossover(t,e){return t!=e&&Math.random()<this.crossoverRate?t.crossover(e):[t.copy(),e.copy()]}};s.Chromosome=class e{constructor(){if(this.type="float",this.lower=0,this.upper=0,this.crossoverType="single_point",this.mutationType="random",this.fitness=0,this.genes=[],arguments[0]instanceof e){for(var t of arguments[0].genes)this.genes.push(t);this.type=arguments[0].type,this.lower=arguments[0].lower,this.upper=arguments[0].upper,this.crossoverType=arguments[0].crossoverType,this.mutationType=arguments[0].mutationType}}copy(){return new e(this)}setCrossover(t){this.crossoverType=t}setMutation(t){this.mutationType=t}crossover(t){return"two_point"==this.crossoverType?i.twoPoint(this,t):"pmx"==this.crossoverType?i.PMX(this,t):i.singlePoint(this,t)}mutation(t){"deviate"==this.mutationType?n.deviate(this,t):"random"==this.mutationType?n.random(this,t,this.lower,this.upper,"integer"==this.type):"exchange"==this.mutationType?Math.random()<t&&n.exchange(this):"insertion"==this.mutationType&&Math.random()<t&&n.insertion(this)}initFloat(e,s,i){this.genes=new Array(e);for(let t=0;t<e;t++)this.genes[t]=s+(i-s)*Math.random();this.type="float",this.lower=s,this.upper=i}initInteger(e,s,i){this.genes=new Array(e);for(let t=0;t<e;t++)this.genes[t]=Math.floor(s+(i-s+1)*Math.random());this.type="integer",this.lower=s,this.upper=i}initPermutation(e){this.genes=new Array(e);for(let t=0;t<e;t++)this.genes[t]=t;this.shuffle(),this.type="permutation",this.lower=0,this.upper=e}find(e){return this.genes.findIndex(t=>t===e)}swap(t,e){var s=this.genes[t];this.genes[t]=this.genes[e],this.genes[e]=s}shuffle(){let t=[];for(;this.genes.length;){var e=Math.floor(Math.random()*this.genes.length);t.push(this.genes.splice(e,1)[0])}this.genes=t}toString(t=!1){let e="";if(t)for(let t=0;t<this.genes.length;t++)e+=String.fromCharCode(this.genes[t]);else for(let t=0;t<this.genes.length;t++)e+=this.genes[t];return e}};class i{static singlePoint(t,e){let s=t.copy(),i=e.copy();for(let t=Math.floor(Math.random()*s.genes.length);t<s.genes.length;t++){var n=s.genes[t];s.genes[t]=i.genes[t],i.genes[t]=n}return[s,i]}static twoPoint(t,e){let s=t.copy(),i=e.copy();var e=Math.floor(Math.random()*(s.genes.length-1)),n=Math.floor(e+1+(s.genes.length-e-1)*Math.random());for(let t=e;t<n;t++){var r=s.genes[t];s.genes[t]=i.genes[t],i.genes[t]=r}return[s,i]}static PMX(e,s){let i=e.copy(),n=s.copy();var r=Math.floor(Math.random()*(i.genes.length-1)),h=Math.floor(r+1+(i.genes.length-r-1)*Math.random());for(let t=r;t<=h;t++){var o=e.genes[t],a=s.genes[t];o!=a&&(a=e.find(a),o=s.find(o),i.swap(t,a),n.swap(t,o))}return[i,n]}}s.Crossover=i;class n{static deviate(t,e){let s=t.genes;for(let t=0;t<s.length;t++)Math.random()<e&&(s[t]+=(2*Math.random()-1)*n.maxDeviation)}static random(t,e,s,i,n=!1){let r=t.genes;if(n)for(let t=0;t<r.length;t++)Math.random()<e&&(r[t]=Math.floor(s+(i-s+1)*Math.random()));else for(let t=0;t<r.length;t++)Math.random()<e&&(r[t]=s+(i-s)*Math.random())}static exchange(t){var e=Math.floor(Math.random()*t.genes.length);let s=e;for(;e==s;)s=Math.floor(Math.random()*t.genes.length);var i=t.genes[e];t.genes[e]=t.genes[s],t.genes[s]=i}static insertion(t){var e=Math.floor(Math.random()*t.genes.length);let s=e;for(;e==s;)s=Math.floor(Math.random()*t.genes.length);var i=t.genes[e];t.genes.splice(e,1),t.genes.splice(s,0,i)}}s.Mutation=n,n.maxDeviation=.1;s.NeuralNet=class t{constructor(){if(arguments[0]instanceof t){this.neurons=[];for(let s=0;s<arguments[0].neurons.length;s++){let e=[];for(let t=0;t<arguments[0].neurons[s].length;t++)e.push(arguments[0].neurons[s][t].copy());this.neurons.push(e)}}else if(this.neurons=[],0<arguments[2]){this.addLayer(arguments[0],arguments[3]);for(let t=0;t<arguments[2]-1;t++)this.addLayer(arguments[3],arguments[3]);this.addLayer(arguments[3],arguments[1])}else this.addLayer(arguments[0],arguments[1])}addLayer(e,s){let i=new Array(s);for(let t=0;t<s;t++)i[t]=new r(e);this.neurons.push(i)}copy(){return new t(this)}feedforward(s){let i=[];for(let e=0;e<this.neurons.length;e++){0<e&&(s=[...i],i=[]);for(let t=0;t<this.neurons[e].length;t++)i.push(this.neurons[e][t].activate(s))}return i}weights(){if(1!=arguments.length){let i=[];for(let s=0;s<this.neurons.length;s++)for(let e=0;e<this.neurons[s].length;e++)for(let t=0;t<this.neurons[s][e].weights.length;t++)i.push(this.neurons[s][e].weights[t]);return i}{let i=0;for(let s=0;s<this.neurons.length;s++)for(let e=0;e<this.neurons[s].length;e++)for(let t=0;t<this.neurons[s][e].weights.length;t++)this.neurons[s][e].weights[t]=arguments[0][i],i++}}indexes(){let t=[],i=0;for(let s=0;s<this.neurons.length;s++)for(let e=0;e<this.neurons[s].length;e++){t.push(i);for(let t=0;t<this.neurons[s][e].weights.length;t++)i++}return t}};class r{constructor(){if(arguments[0]instanceof r){this.weights=new Array(arguments[0].weights.length);for(let t=0;t<this.weights.length;t++)this.weights[t]=arguments[0].weights[t]}else{this.weights=new Array(arguments[0]+1);for(let t=0;t<this.weights.length;t++)this.weights[t]=2*Math.random()-1}}copy(){return new r(this)}activate(e){let s=0;for(let t=0;t<this.weights.length-1;t++)s+=this.weights[t]*e[t];return s+=this.weights[this.weights.length-1],this.sigmoid(s)}sigmoid(t){return 1/(1+Math.exp(-t))}}s.Neuron=r},{}],3:[function(t,e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Cell=s.CellVertex=s.LimitedVoronoi=s.Voronoi=s.Delaunay=s.ConvexHull=s.QuadTree=s.Polygon=s.Rect=s.Triangle=s.Circle=s.Sector=s.Spline=s.Polyline=s.Arc=s.Line=s.Point=s.Vector=void 0;class m{constructor(){1==arguments.length?(this.x=arguments[0].x,this.y=arguments[0].y):2==arguments.length?(this.x=arguments[0],this.y=arguments[1]):(this.x=0,this.y=0)}copy(){return new m(this.x,this.y)}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}magSq(){return this.x*this.x+this.y*this.y}angle(){if(0==arguments.length)return Math.atan2(this.y,this.x);if(1==arguments.length){let t=this.normalize();var e=arguments[0].normalize();return Math.sign(t.cross(e))*Math.acos(t.dot(e))}}add(){return 1==arguments.length?new m(this.x+arguments[0].x,this.y+arguments[0].y):2==arguments.length?new m(this.x+arguments[0],this.y+arguments[1]):void 0}sub(){return 1==arguments.length?new m(this.x-arguments[0].x,this.y-arguments[0].y):2==arguments.length?new m(this.x-arguments[0],this.y-arguments[1]):void 0}mult(t){return new m(this.x*t,this.y*t)}div(t){return new m(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-t.x*this.y}normalize(){var t=this.x*this.x+this.y*this.y;return 0<t?(t=Math.sqrt(t),new m(this.x/t,this.y/t)):new m}limit(t){return this.magSq()>t*t?this.normalize().mult(t):this.copy()}invert(){return new m(-this.x,-this.y)}perpendicular(){return new m(-this.y,this.x)}projection(t){let e=t.normalize();return e.mult(this.dot(e))}reflect(t){let e=t.normalize();return e.mult(2*this.dot(e)).sub(this)}rotate(t){return new m(Math.cos(t)*this.x-Math.sin(t)*this.y,Math.sin(t)*this.x+Math.cos(t)*this.y)}distance(t){var e=this.x-t.x,t=this.y-t.y;return Math.sqrt(e*e+t*t)}distanceSq(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t}}s.Vector=m;class g{constructor(){1==arguments.length?(this.x=arguments[0].x,this.y=arguments[0].y):2==arguments.length?(this.x=arguments[0],this.y=arguments[1]):(this.x=0,this.y=0)}translate(t,e){return this.x+=t,this.y+=e,this}rotate(){var t,e;return 1==arguments.length?(t=this.x,e=this.y,this.x=Math.cos(arguments[0])*t-Math.sin(arguments[0])*e,this.y=Math.sin(arguments[0])*t+Math.cos(arguments[0])*e):2==arguments.length&&(t=this.x-arguments[1].x,e=this.y-arguments[1].y,this.x=arguments[1].x+Math.cos(arguments[0])*t-Math.sin(arguments[0])*e,this.y=arguments[1].y+Math.sin(arguments[0])*t+Math.cos(arguments[0])*e),this}scale(){return 1==arguments.length?(this.x*=arguments[0],this.y*=arguments[0]):2==arguments.length&&(this.x=arguments[1].x+(this.x-arguments[1].x)*arguments[0],this.y=arguments[1].y+(this.y-arguments[1].y)*arguments[0]),this}copy(){return new g(this.x,this.y)}distance(t){var e=this.x-t.x,t=this.y-t.y;return Math.sqrt(e*e+t*t)}distanceSq(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t}lerp(t,e){return new g(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}}s.Point=g;class v{constructor(){2==arguments.length?(this.p1=arguments[0],this.p2=arguments[1]):4==arguments.length&&(this.p1=new g(arguments[0],arguments[1]),this.p2=new g(arguments[2],arguments[3]))}translate(t,e){return this.p1.translate(t,e),this.p2.translate(t,e),this}rotate(){return 1==arguments.length?(this.p1.rotate(arguments[0]),this.p2.rotate(arguments[0])):2==arguments.length&&(this.p1.rotate(arguments[0],arguments[1]),this.p2.rotate(arguments[0],arguments[1])),this}scale(){return 1==arguments.length?(this.p1.scale(arguments[0]),this.p2.scale(arguments[0])):2==arguments.length&&(this.p1.scale(arguments[0],arguments[1]),this.p2.scale(arguments[0],arguments[1])),this}reverse(){var t=this.p1;return this.p1=this.p2,this.p2=t,this}copy(){return new v(this.p1.copy(),this.p2.copy())}bounds(){return new E(this.p1.copy(),this.p2.copy())}length(){return this.p1.distance(this.p2)}angle(){return new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y).angle()}direction(){return new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y).normalize()}normal(){return this.direction().perpendicular()}middle(){return this.p1.lerp(this.p2,.5)}point(t){return this.p1.lerp(this.p2,t)}lerp(t,e){var s=this.p1.lerp(t.p1,e),e=this.p2.lerp(t.p2,e);return new v(s,e)}closest(t){let e=new m(t.x-this.p1.x,t.y-this.p1.y),s=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y);t=e.dot(s)/s.dot(s);return t<=0?this.p1.copy():1<=t?this.p2.copy():this.p1.lerp(this.p2,t)}distance(t){return t.distance(this.closest(t))}intersects(t){let e=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y),s=new m(t.p2.x-t.p1.x,t.p2.y-t.p1.y),i=new m(t.p1.x-this.p1.x,t.p1.y-this.p1.y);var n=e.perpendicular(),t=s.perpendicular(),t=i.dot(t)/e.dot(t),n=-i.dot(n)/s.dot(n);return 0<=t&&t<=1&&0<=n&&n<=1}intersection(t){let e=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y),s=new m(t.p2.x-t.p1.x,t.p2.y-t.p1.y),i=new m(t.p1.x-this.p1.x,t.p1.y-this.p1.y);var n=e.perpendicular(),t=s.perpendicular(),t=i.dot(t)/e.dot(t),n=-i.dot(n)/s.dot(n);if(0<=t&&t<=1&&0<=n&&n<=1){t=e.mult(t);return new g(this.p1.x+t.x,this.p1.y+t.y)}return null}split(e){var s=e.reduce((t,e)=>t+e);let i=new Array(e.length+1);i[0]=this.p1,i[e.length]=this.p2;let n=0;for(let t=0;t<e.length-1;t++)n+=e[t]/s,i[t+1]=this.p1.lerp(this.p2,n);let r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=new v(i[t].copy(),i[t+1].copy());return r}}s.Line=v;class o{constructor(){var t;4==arguments.length?(this.p=arguments[0],this.r=arguments[1],this.start=arguments[2],this.end=arguments[3]):5==arguments.length&&(this.p=new g(arguments[0],arguments[1]),this.r=arguments[2],this.start=arguments[3],this.end=arguments[4]),this.start>this.end&&(t=this.start,this.start=this.end,this.end=t)}translate(t,e){return this.p.translate(t,e),this}rotate(){return 1==arguments.length?this.p.rotate(arguments[0]):2==arguments.length&&this.p.rotate(arguments[0],arguments[1]),this.start+=arguments[0],this.end+=arguments[0],this}scale(){return 1==arguments.length?this.p.scale(arguments[0]):2==arguments.length&&this.p.scale(arguments[0],arguments[1]),this.r*=arguments[0],this}copy(){return new o(this.p.copy(),this.r,this.start,this.end)}bounds(){let e=new g(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new g(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);var i=Math.PI/2;let n=Math.floor(this.start/i)*i+i,r=new g;for(let t=0;t<4&&n<this.end;t++)r.x=this.p.x+Math.cos(n)*this.r,r.y=this.p.y+Math.sin(n)*this.r,e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),s.x=Math.max(s.x,r.x),s.y=Math.max(s.y,r.y),n+=i;return r=this.point(0),e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),s.x=Math.max(s.x,r.x),s.y=Math.max(s.y,r.y),r=this.point(1),e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),s.x=Math.max(s.x,r.x),s.y=Math.max(s.y,r.y),new E(e,s)}length(){return(this.end-this.start)*this.r}middle(){return this.point(.5)}point(t){var e=this.start+(this.end-this.start)*t,t=this.p.x+Math.cos(e)*this.r,e=this.p.y+Math.sin(e)*this.r;return new g(t,e)}lerp(t,e){var s=this.p.lerp(t.p,e),i=this.r+(t.r-this.r)*e,n=this.start+(t.start-this.start)*e,e=this.end+(t.end-this.end)*e;return new o(s,i,n,e)}contains(t){let e=t.angle();e<0&&(e+=2*Math.PI);var s=this.start%(2*Math.PI),t=this.end%(2*Math.PI);return t<=s?e>s&&e<2*Math.PI||0<e&&e<t:e>s&&e<t}closest(t){let e=new m(t.x-this.p.x,t.y-this.p.y);if(this.contains(e))return e=e.normalize().mult(this.r).add(this.p.x,this.p.y),new g(e.x,e.y);var s=this.point(0),i=this.point(1);return t.distanceSq(s)<t.distanceSq(i)?s:i}distance(t){return t.distance(this.closest(t))}polyline(e){let s=new Array(e+1);for(let t=0;t<=e;t++){var i=this.start+(this.end-this.start)*t/e,n=this.p.x+Math.cos(i)*this.r,i=this.p.y+Math.sin(i)*this.r;s[t]=new g(n,i)}return new r(s)}split(e){var s=e.reduce((t,e)=>t+e);let i=new Array(e.length+1);i[0]=this.start,i[e.length]=this.end;let n=this.start;for(let t=0;t<e.length-1;t++)n+=e[t]/s*(this.end-this.start),i[t+1]=n;let r=new Array(e.length);for(let t=0;t<r.length;t++)r[t]=new o(this.p.copy(),this.r,i[t],i[t+1]);return r}}s.Arc=o;class r{constructor(){this.vertices=1==arguments.length?arguments[0]:new Array}add(){return 1==arguments.length?this.vertices.push(arguments[0]):2==arguments.length&&this.vertices.push(new g(arguments[0],arguments[1])),this}clear(){this.vertices=[]}translate(t,e){for(var s of this.vertices)s.translate(t,e);return this}rotate(){if(1==arguments.length)for(var t of this.vertices)t.rotate(arguments[0]);else if(2==arguments.length)for(var e of this.vertices)e.rotate(arguments[0],arguments[1]);return this}scale(){if(1==arguments.length)for(var t of this.vertices)t.scale(arguments[0]);else if(2==arguments.length)for(var e of this.vertices)e.scale(arguments[0],arguments[1]);return this}reverse(){return this.vertices.reverse(),this}copy(){let e=new Array(this.vertices.length);for(let t=0;t<this.vertices.length;t++)e[t]=this.vertices[t].copy();return new r(e)}edges(){let e=new Array;for(let t=0;t<this.vertices.length-1;t++){var s=this.vertices[t],i=this.vertices[t+1];e.push(new v(s,i))}return e}bounds(){let t=new g(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e=new g(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var s of this.vertices)t.x=Math.min(t.x,s.x),t.y=Math.min(t.y,s.y),e.x=Math.max(e.x,s.x),e.y=Math.max(e.y,s.y);return new E(t,e)}length(){let s=0;for(let e=0;e<this.vertices.length-1;e++){let t=this.vertices[e];var i=this.vertices[e+1];s+=t.distance(i)}return s}closest(s){let i,n=Number.POSITIVE_INFINITY;for(let e=0;e<this.vertices.length-1;e++){let t=new v(this.vertices[e],this.vertices[e+1]);var r=t.closest(s),h=s.distanceSq(r);h<n&&(i=r,n=h)}return i}distance(t){return t.distance(this.closest(t))}}s.Polyline=r;s.Spline=class t{constructor(){this.points=1==arguments.length?arguments[0]:new Array}compute(t="clamped",s=20){if(!(this.points.length<4)){let e=new Array;"open"==t?e=e.concat(this.points):"closed"==t?(e.push(this.points[this.points.length-2]),e.push(this.points[this.points.length-1]),e=e.concat(this.points),e.push(this.points[0])):(e.push(this.points[0]),e=e.concat(this.points),e.push(this.points[this.points.length-1])),this.vertices=new Array;for(let t=0;t<e.length-3;t++){var i=e[t],n=e[t+1],r=e[t+2],h=e[t+3];for(let t=0;t<s;t++){var o=t/(s-1);this.vertices.push(this.point(i,n,r,h,o))}}}}point(t,e,s,i,n){var r=(t,e,s,i)=>new g(t.x*s+e.x*i,t.y*s+e.y*i),t=r(t,e,-n,n+1),e=r(e,s,1-n,n),i=r(s,i,2-n,n-1);return r(r(t,e,(1-n)/2,(n+1)/2),r(e,i,(2-n)/2,n/2),1-n,n)}tangent(t,e,s,i,n){var r=this.point(t,e,s,i,n),n=this.point(t,e,s,i,n+1e-6);return new m(n.x-r.x,n.y-r.y).normalize()}normal(t,e,s,i,n){return this.tangent(t,e,s,i,n).perpendicular()}add(){return 1==arguments.length?this.points.push(arguments[0]):2==arguments.length&&this.points.push(new g(arguments[0],arguments[1])),this}clear(){this.points=[],this.vertices=[]}translate(t,e){for(var s of this.points)s.translate(t,e);return this}rotate(){if(1==arguments.length)for(var t of this.points)t.rotate(arguments[0]);else if(2==arguments.length)for(var e of this.points)e.rotate(arguments[0],arguments[1]);return this}scale(){if(1==arguments.length)for(var t of this.points)t.scale(arguments[0]);else if(2==arguments.length)for(var e of this.points)e.scale(arguments[0],arguments[1]);return this}reverse(){return this.points.reverse(),this}copy(){let e=new Array(this.points.length);for(let t=0;t<this.points.length;t++)e[t]=this.points[t].copy();return new t(e)}};class a{constructor(){var t;5==arguments.length?(this.p=arguments[0],this.r1=arguments[1],this.r2=arguments[2],this.start=arguments[3],this.end=arguments[4]):6==arguments.length&&(this.p=new g(arguments[0],arguments[1]),this.r1=arguments[2],this.r2=arguments[3],this.start=arguments[4],this.end=arguments[5]),this.start>this.end&&(t=this.start,this.start=this.end,this.end=t)}translate(t,e){return this.p.translate(t,e),this}rotate(){return 1==arguments.length?this.p.rotate(arguments[0]):2==arguments.length&&this.p.rotate(arguments[0],arguments[1]),this.start+=arguments[0],this.end+=arguments[0],this}scale(){return 1==arguments.length?this.p.scale(arguments[0]):2==arguments.length&&this.p.scale(arguments[0],arguments[1]),this.r1*=arguments[0],this.r2*=arguments[0],this}copy(){return new a(this.p.copy(),this.r1,this.r2,this.start,this.end)}bounds(){let t=new o(this.p,this.r1,this.start,this.end).bounds();var e=new o(this.p,this.r2,this.start,this.end).bounds();return t.merge(e)}area(){return(this.end-this.start)/2*(this.r2*this.r2-this.r1*this.r1)}center(){var t=(this.start+this.end)/2,e=(this.r1+this.r2)/2,s=this.p.x+Math.cos(t)*e,e=this.p.y+Math.sin(t)*e;return new g(s,e)}contains(t){let e=new m(t.x-this.p.x,t.y-this.p.y);t=e.mag();return t>this.r1&&t<this.r2&&new o(this.p,this.r2,this.start,this.end).contains(e)}closest(e){let t=new o(this.p,this.r1,this.start,this.end),s=new o(this.p,this.r2,this.start,this.end);var i=[t.closest(e),s.closest(e),new v(t.point(0),s.point(0)).closest(e),new v(t.point(1),s.point(1)).closest(e)];let n,r=Number.POSITIVE_INFINITY;for(let t=0;t<4;t++){var h=e.distanceSq(i[t]);h<r&&(n=i[t],r=h)}return n}distance(t){return t.distance(this.closest(t))}polygon(e){let s=new Array(2*e+2);for(let t=0;t<=e;t++){var i=this.start+(this.end-this.start)*t/e;this.p.x,Math.cos(i),this.r2,this.p.y,Math.sin(i),this.r2;s[t]=new g(this.p.x+Math.cos(i)*this.r2,this.p.y+Math.sin(i)*this.r2),s[e+1+t]=new g(this.p.x+Math.cos(this.start+this.end-i)*this.r1,this.p.y+Math.sin(this.start+this.end-i)*this.r1)}return new w(s)}split(n,t="angle"){var r=n.reduce((t,e)=>t+e);if("angle"==t){let e=new Array(n.length+1);e[0]=this.start,e[n.length]=this.end;let s=this.start;for(let t=0;t<n.length-1;t++)s+=n[t]/r*(this.end-this.start),e[t+1]=s;let i=new Array(n.length);for(let t=0;t<i.length;t++)i[t]=new a(this.p.copy(),this.r1,this.r2,e[t],e[t+1]);return i}if("radius"==t){let e=new Array(n.length+1);e[0]=this.r1,e[n.length]=this.r2;let s=this.r1;for(let t=0;t<n.length-1;t++)s+=n[t]/r*(this.r2-this.r1),e[t+1]=s;let i=new Array(n.length);for(let t=0;t<i.length;t++)i[t]=new a(this.p.copy(),e[t],e[t+1],this.start,this.end);return i}if("area"==t){var h=this.area();let e=new Array(n.length+1);e[0]=this.r1,e[n.length]=this.r2;let s=this.r1;for(let t=0;t<n.length-1;t++)e[t+1]=Math.sqrt(n[t]/r*h*2/(this.end-this.start)+s*s),s=e[t+1];let i=new Array(n.length);for(let t=0;t<i.length;t++)i[t]=new a(this.p.copy(),e[t],e[t+1],this.start,this.end);return i}}}s.Sector=a;class u{constructor(){if(0==arguments.length)this.p=new g,this.r=1;else if(2==arguments.length)this.p=arguments[0],this.r=arguments[1];else if(3==arguments.length)if(arguments[0]instanceof g){let t=new m(arguments[2].x-arguments[1].x,arguments[2].y-arguments[1].y);var i=new m(arguments[0].x-arguments[2].x,arguments[0].y-arguments[2].y);let e=new m(arguments[1].x-arguments[0].x,arguments[1].y-arguments[0].y),s=e.perpendicular();i=s.mult(t.dot(i)/s.dot(i)).add(e).mult(.5).add(arguments[0].x,arguments[0].y);this.p=new g(i.x,i.y),this.r=this.p.distance(arguments[0])}else this.p=new g(arguments[0],arguments[1]),this.r=arguments[2]}translate(t,e){return this.p.translate(t,e),this}rotate(){return 1==arguments.length?this.p.rotate(arguments[0]):2==arguments.length&&this.p.rotate(arguments[0],arguments[1]),this}scale(){return 1==arguments.length?this.p.scale(arguments[0]):2==arguments.length&&this.p.scale(arguments[0],arguments[1]),this.r*=arguments[0],this}copy(){return new u(this.p.copy(),this.r)}bounds(){var t=new g(this.p.x-this.r,this.p.y-this.r),e=new g(this.p.x+this.r,this.p.y+this.r);return new E(t,e)}area(){return Math.PI*this.r*this.r}circumference(){return 2*Math.PI*this.r}tangent(t){let e=this.p.lerp(t,.5);t=e.distance(t),t=new u(e,t);return this.intersection(t)}contains(t){if(t instanceof g){var e=this.p.x-t.x,s=this.p.y-t.y;return e*e+s*s<this.r*this.r}if(t instanceof u){e=this.p.x-t.p.x,s=this.p.y-t.p.y,t=this.r-t.r;return e*e+s*s<t*t}}closest(t){t=new m(t.x-this.p.x,t.y-this.p.y).normalize().mult(this.r).add(this.p.x,this.p.y);return new g(t.x,t.y)}distance(t){return Math.abs(t.distance(this.p)-this.r)}intersects(s){if(s instanceof u){var t=this.p.x-s.p.x,e=this.p.y-s.p.y,i=this.r+s.r;return t*t+e*e<=i*i}if(s instanceof E){let t=this.p.x,e=this.p.y;t<s.p.x?t=s.p.x:t>s.p.x+s.w&&(t=s.p.x+s.w),e<s.p.y?e=s.p.y:e>s.p.y+s.h&&(e=s.p.y+s.h);i=this.p.x-t,s=this.p.y-e;return i*i+s*s<=this.r*this.r}}intersection(t){var e=this.p.distance(t.p);if(e>this.r+t.r||e<Math.abs(this.r-t.r))return null;e=Math.acos((this.r*this.r+e*e-t.r*t.r)/(2*this.r*e));let s=new m(t.p.x-this.p.x,t.p.y-this.p.y),i=s.copy();return s=s.normalize().mult(this.r).rotate(e).add(this.p.x,this.p.y),i=i.normalize().mult(this.r).rotate(-e).add(this.p.x,this.p.y),[new g(s.x,s.y),new g(i.x,i.y)]}polygon(e){let s=new Array(e);for(let t=0;t<e;t++){var i=2*Math.PI*t/e,n=this.p.x+Math.cos(i)*this.r,i=this.p.y+Math.sin(i)*this.r;s[t]=new g(n,i)}return new w(s)}split(t,e="angle"){return new a(this.p,0,this.r,0,2*Math.PI).split(t,e)}}s.Circle=u;class _{constructor(){3==arguments.length?(this.p1=arguments[0],this.p2=arguments[1],this.p3=arguments[2]):6==arguments.length&&(this.p1=new g(arguments[0],arguments[1]),this.p2=new g(arguments[2],arguments[3]),this.p3=new g(arguments[4],arguments[5]))}translate(t,e){return this.p1.translate(t,e),this.p2.translate(t,e),this.p3.translate(t,e),this}rotate(){return 1==arguments.length?(this.p1.rotate(arguments[0]),this.p2.rotate(arguments[0]),this.p3.rotate(arguments[0])):2==arguments.length&&(this.p1.rotate(arguments[0],arguments[1]),this.p2.rotate(arguments[0],arguments[1]),this.p3.rotate(arguments[0],arguments[1])),this}scale(){return 1==arguments.length?(this.p1.scale(arguments[0]),this.p2.scale(arguments[0]),this.p3.scale(arguments[0])):2==arguments.length&&(this.p1.scale(arguments[0],arguments[1]),this.p2.scale(arguments[0],arguments[1]),this.p3.scale(arguments[0],arguments[1])),this}reverse(){var t=this.p1;return this.p1=this.p3,this.p3=t,this}copy(){return new _(this.p1.copy(),this.p2.copy(),this.p3.copy())}bounds(){var t=Math.min(Math.min(this.p1.x,this.p2.x),this.p3.x),e=Math.min(Math.min(this.p1.y,this.p2.y),this.p3.y),s=Math.max(Math.max(this.p1.x,this.p2.x),this.p3.x),i=Math.max(Math.max(this.p1.y,this.p2.y),this.p3.y);return new E(new g(t,e),new g(s,i))}edges(){let t=new Array(3);return t[0]=new v(this.p1,this.p2),t[1]=new v(this.p2,this.p3),t[2]=new v(this.p3,this.p1),t}polygon(){return new w([this.p1,this.p2,this.p3])}area(){let t=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y);var e=new m(this.p3.x-this.p1.x,this.p3.y-this.p1.y);return t.cross(e)/2}circumference(){return this.p1.distance(this.p2)+this.p2.distance(this.p3)+this.p3.distance(this.p1)}centroid(){var t=(this.p1.x+this.p2.x+this.p3.x)/3,e=(this.p1.y+this.p2.y+this.p3.y)/3;return new g(t,e)}clockwise(){let t=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y);var e=new m(this.p3.x-this.p2.x,this.p3.y-this.p2.y);return 0<t.cross(e)}contains(i){if(i instanceof g){let t=new m(this.p2.x-this.p1.x,this.p2.y-this.p1.y),e=new m(this.p3.x-this.p2.x,this.p3.y-this.p2.y),s=new m(this.p1.x-this.p3.x,this.p1.y-this.p3.y);var n=new m(i.x-this.p1.x,i.y-this.p1.y),r=new m(i.x-this.p2.x,i.y-this.p2.y),h=new m(i.x-this.p3.x,i.y-this.p3.y);return this.clockwise()?0<t.cross(n)&&0<e.cross(r)&&0<s.cross(h):t.cross(n)<0&&e.cross(r)<0&&s.cross(h)<0}if(i instanceof _)return this.contains(i.p1)&&this.contains(i.p2)&&this.contains(i.p3)}closest(s){let i,n=Number.POSITIVE_INFINITY;var r=[this.p1,this.p2,this.p3];for(let e=0;e<r.length;e++){let t=new v(r[e],r[(e+1)%r.length]);var h=t.closest(s),o=s.distanceSq(h);o<n&&(i=h,n=o)}return i}distance(t){return t.distance(this.closest(t))}circumcircle(){return new u(this.p1,this.p2,this.p3)}}s.Triangle=_;class E{constructor(){2==arguments.length?(this.p=new g(Math.min(arguments[0].x,arguments[1].x),Math.min(arguments[0].y,arguments[1].y)),this.w=Math.abs(arguments[0].x-arguments[1].x),this.h=Math.abs(arguments[0].y-arguments[1].y)):3==arguments.length?(this.p=arguments[0],this.w=arguments[1],this.h=arguments[2]):4==arguments.length&&(this.p=new g(arguments[0],arguments[1]),this.w=arguments[2],this.h=arguments[3])}translate(t,e){return this.p.translate(t,e),this}scale(){return 1==arguments.length?this.p.scale(arguments[0]):2==arguments.length&&this.p.scale(arguments[0],arguments[1]),this.w*=arguments[0],this.h*=arguments[0],this}copy(){return new E(this.p.x,this.p.y,this.w,this.h)}centroid(){return new g(this.p.x+.5*this.w,this.p.y+.5*this.h)}area(){return this.w*this.h}circumference(){return 2*(this.w+this.h)}vertices(){let t=new Array(4);return t[0]=this.p.copy(),t[1]=new g(this.p.x+this.w,this.p.y),t[2]=new g(this.p.x+this.w,this.p.y+this.h),t[3]=new g(this.p.x,this.p.y+this.h),t}edges(){var t=this.vertices();let e=new Array(4);return e[0]=new v(t[0],t[1]),e[1]=new v(t[1],t[2]),e[2]=new v(t[2],t[3]),e[3]=new v(t[3],t[0]),e}polygon(){return new w(this.vertices())}merge(t){var e=new g(Math.min(this.p.x,t.p.x),Math.min(this.p.y,t.p.y)),t=new g(Math.max(this.p.x+this.w,t.p.x+t.w),Math.max(this.p.y+this.h,t.p.y+t.h));return new E(e,t)}contains(t){return t instanceof g?t.x>=this.p.x&&t.x<=this.p.x+this.w&&t.y>=this.p.y&&t.y<=this.p.y+this.h:t instanceof u?t.p.x-t.r>=this.p.x&&t.p.x+t.r<=this.p.x+this.w&&t.p.y-t.r>=this.p.y&&t.p.y+t.r<=this.p.y+this.h:t instanceof E?t.p.x>=this.p.x&&t.p.y>=this.p.y&&t.p.x+t.w<=this.p.x+this.w&&t.p.y+t.h<=this.p.y+this.h:void 0}closest(t){var i=this.p.x,n=this.p.y,r=this.p.x+this.w,h=this.p.y+this.h;if(t.x<i)return new g(i,Math.min(Math.max(t.y,n),h));if(t.y<n)return new g(Math.min(Math.max(t.x,i),r),n);if(t.x>r)return new g(r,Math.min(Math.max(t.y,n),h));if(t.y>h)return new g(Math.min(Math.max(t.x,i),r),h);{let e;var o=[Math.abs(t.x-i),Math.abs(t.y-n),Math.abs(t.x-r),Math.abs(t.y-h)],a=[new g(i,t.y),new g(t.x,n),new g(r,t.y),new g(t.x,h)];let s=Number.POSITIVE_INFINITY;for(let t=0;t<4;t++)o[t]<s&&(e=a[t],s=o[t]);return e}}distance(t){return t.distance(this.closest(t))}intersects(t){return t instanceof g?this.contains(t):t instanceof u?t.intersects(this):t instanceof E?this.p.x<=t.p.x+t.w&&this.p.x+this.w>=t.p.x&&this.p.y<=t.p.y+t.h&&this.p.y+this.h>=t.p.y:void 0}intersection(e){if(!this.intersects(e))return null;let s=new Array;var i=this.vertices(),n=e.vertices();for(let t=0;t<4;t++)e.contains(i[t])&&s.push(i[t]),this.contains(n[t])&&s.push(n[t]);let r=this.edges();var h=e.edges();for(let e=0;e<4;e++)for(let t=0;t<4;t++){var o=r[e].intersection(h[t]);null!=o&&s.push(o)}let a=s[0].copy(),l=s[0].copy();for(let t=0;t<s.length;t++){var c=s[t];c.x<a.x&&(a.x=c.x),c.x>l.x&&(l.x=c.x),c.y<a.y&&(a.y=c.y),c.y>l.y&&(l.y=c.y)}return new E(a,l)}split(s,t="squarify"){if("dice"==t)return this.dice(s);if("slice"==t)return this.slice(s);if("squarify"==t){var i=s.reduce((t,e)=>t+e);let e=new Array(s.length);for(let t=0;t<s.length;t++)e[t]=s[t]/i*this.area();return this.squarify(e,this.p.x,this.p.y,this.w,this.h)}}dice(e){var s=e.reduce((t,e)=>t+e);let i=this.p.copy();var n=new g(this.p.x+this.w,this.p.y),r=new g(this.p.x+this.w,this.p.y+this.h);let h=new g(this.p.x,this.p.y+this.h),o=new Array(e.length),a=new Array(e.length);o[0]=i,a[e.length-1]=r;let l=0;for(let t=0;t<e.length-1;t++)l+=e[t]/s,o[t+1]=i.lerp(n,l),a[t]=h.lerp(r,l);let c=new Array(e.length);for(let t=0;t<e.length;t++)c[t]=new E(o[t],a[t]);return c}slice(e){var s=e.reduce((t,e)=>t+e);let i=this.p.copy(),n=new g(this.p.x+this.w,this.p.y);var r=new g(this.p.x+this.w,this.p.y+this.h),h=new g(this.p.x,this.p.y+this.h);let o=new Array(e.length),a=new Array(e.length);o[0]=i,a[e.length-1]=r;let l=0;for(let t=0;t<e.length-1;t++)l+=e[t]/s,o[t+1]=i.lerp(h,l),a[t]=n.lerp(r,l);let c=new Array(e.length);for(let t=0;t<e.length;t++)c[t]=new E(o[t],a[t]);return c}squarify(r,h,o,a,l){var c=(t,e)=>e<t?t/e:e/t,t=l<a,p=t?l:a;let u=new Array;if(t)for(let n=0;n<r.length;n++){let t=0==u.length?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY,e=0;for(var f of u)t=Math.max(t,c(f.w,f.h));for(var y of u)e+=y.area();var d,x=(e+r[n])/p,m=r[n]/x;let s=o;for(d of u)s+=d.area()/x;var g,v,_=new E(h,s,x,m);let i=c(_.w,_.h);for(g of u)i=Math.max(i,c(x,g.area()/x));if(!(i<t)){e=0;for(var w of u)e+=w.area();m=e/p;u=u.concat(this.squarify(r.slice(n),h+m,o,a-m,l));break}u.push(_),s=o;for(v of u)[v.h,v.w,v.p.y]=[v.area()/x,x,s],s+=v.h}else for(let n=0;n<r.length;n++){let t=0==u.length?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY,e=0;for(var I of u)t=Math.max(t,c(I.w,I.h));for(var b of u)e+=b.area();var M,N=(e+r[n])/p,T=r[n]/N;let s=h;for(M of u)s+=M.area()/N;var P,A,F=new E(s,o,T,N);let i=c(F.w,F.h);for(P of u)i=Math.max(i,c(P.area()/N,N));if(!(i<t)){e=0;for(var k of u)e+=k.area();T=e/p;u=u.concat(this.squarify(r.slice(n),h,o+T,a,l-T));break}u.push(F),s=h;for(A of u)[A.w,A.h,A.p.x]=[A.area()/N,N,s],s+=A.w}return u}clip(t){return new w(this.vertices()).clip(t)}}s.Rect=E;class w{constructor(){this.vertices=1==arguments.length?arguments[0]:new Array}add(){return 1==arguments.length?this.vertices.push(arguments[0]):2==arguments.length&&this.vertices.push(new g(arguments[0],arguments[1])),this}clear(){this.vertices=[]}translate(t,e){for(var s of this.vertices)s.translate(t,e);return this}rotate(){if(1==arguments.length)for(var t of this.vertices)t.rotate(arguments[0]);else if(2==arguments.length)for(var e of this.vertices)e.rotate(arguments[0],arguments[1]);return this}scale(){if(1==arguments.length)for(var t of this.vertices)t.scale(arguments[0]);else if(2==arguments.length)for(var e of this.vertices)e.scale(arguments[0],arguments[1]);return this}reverse(){return this.vertices.reverse(),this}edges(){let e=new Array;for(let t=0;t<this.vertices.length;t++){var s=this.vertices[t],i=this.vertices[(t+1)%this.vertices.length];e.push(new v(s,i))}return e}bounds(){let t=new g(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e=new g(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var s of this.vertices)t.x=Math.min(t.x,s.x),t.y=Math.min(t.y,s.y),e.x=Math.max(e.x,s.x),e.y=Math.max(e.y,s.y);return new E(t,e)}area(){let s=0;for(let e=0;e<this.vertices.length;e++){var i=this.vertices[e],n=this.vertices[(e+1)%this.vertices.length];let t=new m(i.x,i.y);n=new m(n.x,n.y);s+=t.cross(n)}return s/=2,s}circumference(){let s=0;for(let e=0;e<this.vertices.length;e++){let t=this.vertices[e];var i=this.vertices[(e+1)%this.vertices.length];s+=t.distance(i)}return s}centroid(){var t=this.area();let s=0,i=0;for(let e=0;e<this.vertices.length;e++){var n=this.vertices[e],r=this.vertices[(e+1)%this.vertices.length];let t=new m(n.x,n.y);var h=new m(r.x,r.y),h=t.cross(h);s+=(n.x+r.x)*h,i+=(n.y+r.y)*h}return new g(s/6/t,i/6/t)}clockwise(){return 0<this.area()}convex(){var s=this.clockwise();for(let e=0;e<this.vertices.length;e++){var i=this.vertices[e],n=this.vertices[(e+1)%this.vertices.length],r=this.vertices[(e+2)%this.vertices.length];let t=new m(n.x-i.x,n.y-i.y);n=new m(r.x-n.x,r.y-n.y);if(s){if(t.cross(n)<0)return!1}else if(0<t.cross(n))return!1}return!0}contains(s){if(this.vertices.length<3)return!1;if(s instanceof g){let e=0;for(let t=0;t<this.vertices.length;t++){var i=this.vertices[t],n=this.vertices[(t+1)%this.vertices.length];(i.x<=s.x&&s.x<n.x||n.x<=s.x&&s.x<i.x)&&(i=(n.y-i.y)/(n.x-i.x)*(s.x-i.x)+i.y,s.y<i&&e++)}return e%2!=0}if(s instanceof w){for(let t=0;t<s.vertices.length;t++)if(!this.contains(s.vertices[t]))return!1;return!0}}closest(s){let i,n=Number.POSITIVE_INFINITY;for(let e=0;e<this.vertices.length;e++){let t=new v(this.vertices[e],this.vertices[(e+1)%this.vertices.length]);var r=t.closest(s),h=s.distanceSq(r);h<n&&(i=r,n=h)}return i}distance(t){return t.distance(this.closest(t))}clip(s){let[i,n]=[0,0],r=new Array;for(let t=0;t<this.vertices.length;t++){var h=this.vertices[t],o=this.vertices[(t+1)%this.vertices.length];let e=new v(h,o);s.contains(h)&&(r.push(h),[i,n]=[i+h.x,n+h.y]);for(let t=0;t<s.vertices.length;t++){var a=s.vertices[t],l=s.vertices[(t+1)%s.vertices.length],l=new v(a,l),l=e.intersection(l);null!=l&&(r.push(l),[i,n]=[i+l.x,n+l.y])}}for(let t=0;t<s.vertices.length;t++){var e=s.vertices[t];this.contains(e)&&(r.push(e),[i,n]=[i+e.x,n+e.y])}return[i,n]=[i/r.length,n/r.length],r.sort(function(t,e){t=new m(t.x-i,t.y-n).angle(),e=new m(e.x-i,e.y-n).angle();return e<t?1:t==e?0:-1}),0<r.length?new w(r):null}}s.Polygon=w;s.QuadTree=class r{constructor(t,e=4,s=4,i=0){this.bounds=t,this.capacity=e,this.maxLevels=s,this._level=i,this.children=null,this.objects=[]}leaf(){return null==this.children}clear(){this.children=null,this.objects=[]}insert(e){if(e instanceof Array)for(let t=0;t<e.length;t++)this.insert(e[t]);else if(this.children)for(let t=0;t<4;t++)this.children[t].bounds.intersects(e.bounds())&&this.children[t].insert(e);else if(this.objects.push(e),this.objects.length>this.capacity&&this._level<this.maxLevels){var t=this.bounds.p.x,s=this.bounds.p.y,i=this.bounds.w/2,n=this.bounds.h/2;this.children=[new r(new E(t,s,i,n),this.capacity,this.maxLevels,this._level+1),new r(new E(t+i,s,i,n),this.capacity,this.maxLevels,this._level+1),new r(new E(t+i,s+n,i,n),this.capacity,this.maxLevels,this._level+1),new r(new E(t,s+n,i,n),this.capacity,this.maxLevels,this._level+1)];for(let e=0;e<this.objects.length;e++)for(let t=0;t<4;t++)this.children[t].bounds.intersects(this.objects[e].bounds())&&this.children[t].insert(this.objects[e]);this.objects=[]}}query(e){let s=this.objects;if(this.children)for(let t=0;t<4;t++)this.children[t].bounds.intersects(e)&&(s=s.concat(this.children[t].query(e)));return s=s.filter((t,e)=>s.indexOf(t)===e),s}};s.ConvexHull=class{compute(t){if(t.length<3)return this.vertices=t,void(this.region=new w(t));let s=t.slice();s.sort(function(t,e){return t.y>e.y?1:t.y==e.y?t.x-e.x:-1});let n=new g(s[0].x-1,s[0].y);new m(1,0);s.sort(function(t,e){var s=new m(t.x-n.x,t.y-n.y).angle(),i=new m(e.x-n.x,e.y-n.y).angle();return i<s?1:s==i?t.distanceSq(n)-e.distanceSq(n):-1});let i=new Array;for(let t=0;t<s.length;t++)if(i.length<2)i.push(s[t]);else{i.push(s[t]);let e;do{var r=i[i.length-3],h=i[i.length-2],o=i[i.length-1];let t=new m(h.x-r.x,h.y-r.y);r=new m(o.x-r.x,o.y-r.y);0<t.cross(r)?e=!0:(e=!1,i.splice(i.length-2,1))}while(3<=i.length&&!e)}this.vertices=i,this.region=new w(this.vertices)}};s.Delaunay=class{compute(n){let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++)e=Math.min(n[t].x,e),s=Math.min(n[t].y,s),i=Math.max(n[t].x,i),r=Math.max(n[t].y,r);var t=(e+i)/2,h=(s+r)/2,o=new g(1e7+t,h),a=new g(t-5e6,1e7+h),h=new g(t-5e6,h-1e7),l=new _(o,a,h);let c=new Array;c.push(l);for(let s=0;s<n.length;s++){let i=new Array;for(let e=c.length-1;0<=e;e--){let t=c[e];t.circumcircle().contains(n[s])&&(i.push(new v(t.p1,t.p2)),i.push(new v(t.p2,t.p3)),i.push(new v(t.p3,t.p1)),c.splice(e,1))}for(let t=0;t<i.length-1;t++){let s=i[t];for(let e=t+1;e<i.length;e++){let t=i[e];(s.p1==t.p1&&s.p2==t.p2||s.p1==t.p2&&s.p2==t.p1)&&(s.__remove=!0,t.__remove=!0)}}for(let t=i.length-1;0<=t;t--){var p=i[t];p.__remove?i.splice(t,1):c.push(new _(n[s],p.p1,p.p2))}}let u=new Array;for(let t=c.length-1;0<=t;t--){var f=c[t];f.p1==l.p1||f.p1==l.p2||f.p1==l.p3||f.p2==l.p1||f.p2==l.p2||f.p2==l.p3||f.p3==l.p1||f.p3==l.p2||f.p3==l.p3?c.splice(t,1):(u.push(new v(f.p1,f.p2)),u.push(new v(f.p2,f.p3)),u.push(new v(f.p3,f.p1)))}for(let e=u.length-1;0<e;e--){var y=u[e];for(let t=e-1;0<=t;t--){var d=u[t];(y.p1==d.p1&&y.p2==d.p2||y.p1==d.p2&&y.p2==d.p1)&&u.splice(e,1)}}this.vertices=n,this.edges=u,this.triangles=c}};s.Voronoi=class{compute(r){let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let t=0;t<r.length;t++)e=Math.min(r[t].x,e),s=Math.min(r[t].y,s),i=Math.max(r[t].x,i),n=Math.max(r[t].y,n);var t=(e+i)/2,h=(s+n)/2,o=new g(1e7+t,h),a=new g(t-5e6,1e7+h),h=new g(t-5e6,h-1e7),h=new _(o,a,h);let l=new Array;l.push(h);for(let s=0;s<r.length;s++){r[s].__circumcenters=new Array;let i=new Array;for(let e=l.length-1;0<=e;e--){let t=l[e];t.circumcircle().contains(r[s])&&(i.push(new v(t.p1,t.p2)),i.push(new v(t.p2,t.p3)),i.push(new v(t.p3,t.p1)),l.splice(e,1))}for(let t=0;t<i.length-1;t++){let s=i[t];for(let e=t+1;e<i.length;e++){let t=i[e];(s.p1==t.p1&&s.p2==t.p2||s.p1==t.p2&&s.p2==t.p1)&&(s.__remove=!0,t.__remove=!0)}}for(let t=i.length-1;0<=t;t--){var c=i[t];c.__remove?i.splice(t,1):l.push(new _(r[s],c.p1,c.p2))}}let p=new Array;for(let e=0;e<l.length;e++){let t=l[e];t.__circumcenter=t.circumcircle().p,p.push(t.__circumcenter),t.p1.__circumcenters&&t.p1.__circumcenters.push(t.__circumcenter),t.p2.__circumcenters&&t.p2.__circumcenters.push(t.__circumcenter),t.p3.__circumcenters&&t.p3.__circumcenters.push(t.__circumcenter)}let u=new Array;for(let e=0;e<l.length;e++){var f=l[e];for(let t=0;t<e;t++){var y=l[t];(f.p1==y.p1&&f.p2==y.p2||f.p1==y.p2&&f.p2==y.p1||f.p1==y.p2&&f.p2==y.p3||f.p1==y.p3&&f.p2==y.p2||f.p1==y.p3&&f.p2==y.p1||f.p1==y.p1&&f.p2==y.p3||f.p2==y.p1&&f.p3==y.p2||f.p2==y.p2&&f.p3==y.p1||f.p2==y.p2&&f.p3==y.p3||f.p2==y.p3&&f.p3==y.p2||f.p2==y.p3&&f.p3==y.p1||f.p2==y.p1&&f.p3==y.p3||f.p3==y.p1&&f.p1==y.p2||f.p3==y.p2&&f.p1==y.p1||f.p3==y.p2&&f.p1==y.p3||f.p3==y.p3&&f.p1==y.p2||f.p3==y.p3&&f.p1==y.p1||f.p3==y.p1&&f.p1==y.p3)&&u.push(new v(f.__circumcenter,y.__circumcenter))}}let d=new Array;for(let t=0;t<r.length;t++){let n=r[t];n.__circumcenters.sort(function(t,e){let s=new m(t.x-n.x,t.y-n.y),i=new m(e.x-n.x,e.y-n.y);return s.angle()-i.angle()});var x=new w(n.__circumcenters);d.push(x)}this.triangles=l,this.vertices=p,this.edges=u,this.regions=d}};s.LimitedVoronoi=class{compute(e){let n;if(e[0]instanceof u){n=new Array(e.length);for(let t=0;t<e.length;t++)n[t]=new y(e[t].p.x,e[t].p.y,e[t].r)}else n=e;for(let t=0;t<e.length;t++)n[t].clear(),n[t].__lines=new Array,n[t].__points=new Array,n[t].__contained=!1;for(let t=0;t<n.length-1;t++){let s=n[t];for(let e=t+1;e<n.length;e++){let t=n[e];var i=s.p.distance(t.p);i<s.r-t.r&&(t.__contained=!0),i<t.r-s.r&&(s.__contained=!0)}}let l=new Array;for(let e=0;e<n.length-1;e++){let a=n[e];if(!a.__contained)for(let t=e+1;t<n.length;t++){let o=n[t];if(!o.__contained&&a.p.distance(o.p)<a.r+o.r){let t=function(t,e){let s=t.p.distance(e.p),i=(t.r*t.r-e.r*e.r+s*s)/(2*s),n=Math.sqrt(t.r*t.r-i*i),r=new m(e.p.x-t.p.x,e.p.y-t.p.y).normalize().mult(i).add(t.p.x,t.p.y),h=n*(e.p.y-t.p.y)/s,o=n*(e.p.x-t.p.x)/s,a=new g(r.x-h,r.y+o),l=new g(r.x+h,r.y-o),c=(l.x-e.p.x)*(a.y-e.p.y)-(a.x-e.p.x)*(l.y-e.p.y)<0;s<i&&(c=!c);return c?[a,l]:[l,a]}(a,o),e=t[0],s=t[1],i=t[1].copy(),n=t[0].copy();a.__points.push(e),a.__points.push(s),o.__points.push(i),o.__points.push(n);let r=new v(e,s),h=new v(i,n);a.__lines.push(r),o.__lines.push(h),l.push(r),l.push(h),r.__s1=a,r.__s2=o,h.__s1=o,h.__s2=a,e.__l1=r,e.__l2=h,s.__l1=r,s.__l2=h,i.__l1=r,i.__l2=h,n.__l1=r,n.__l2=h,e.__arc=!0,i.__arc=!0}}}for(let s=0;s<l.length-1;s++)for(let t=s+1;t<l.length;t++){let e=l[s];var r=l[t];if((e.__s1!=r.__s2||e.__s2!=r.__s1)&&e.__s1==r.__s1){let t=e.intersection(r);null!=t&&(t.__l1=e,t.__l2=r,e.__s1.__points.push(t))}}for(let t=0;t<n.length;t++){let i=n[t];if(i.__contained)i.state=2;else if(0!=i.__points.length){for(let t=0;t<i.__lines.length;t++){let s=i.__lines[t];for(let e=i.__points.length-1;0<=e;e--){var h=i.__points[e];if(h.__l1!=s&&h.__l2!=s){let t=new m(h.x-s.p1.x,h.y-s.p1.y);t.cross(s.direction())<0&&i.__points.splice(e,1)}}}let s=new m;for(let t=0;t<i.__points.length;t++){var o=i.__points[t];s=s.add(o.x,o.y)}s=s.div(i.__points.length),i.__points.sort(function(t,e){return new m(t.x-s.x,t.y-s.y).angle()-new m(e.x-s.x,e.y-s.y).angle()});for(let e=i.__points.length-1;1<e;e--){let t=i.__points[e];var a=i.__points[e-1];t.distance(a)<1e-4&&i.__points.splice(e,1)}if(0<i.__points.length){i.state=1;for(let t=0;t<i.__points.length;t++){var c=i.__points[t],p=new m(c.x,c.y).sub(i.p.x,i.p.y).angle();i.vertices.push(new f(c.x,c.y,p,c.__arc?1:0))}}else i.state=2}else i.state=0}this.cells=n}};class f{constructor(t,e,s,i){this.x=t,this.y=e,this.a=s,this.type=i}}s.CellVertex=f;class y{constructor(){2==arguments.length?(this.p=arguments[0],this.r=arguments[1]):3==arguments.length&&(this.p=new g(arguments[0],arguments[1]),this.r=arguments[2]),this.vertices=new Array}clear(){this.vertices=[]}polygon(s){if(1!=this.state)return new u(this.p,this.r).polygon(s);let i=new Array;for(let t=0;t<this.vertices.length;t++){var n=this.vertices[t],r=this.vertices[(t+1)%this.vertices.length];if(0==n.type)i.push(new g(n.x,n.y));else{var h=n.a;let e=r.a;h>e&&(e+=2*Math.PI);var o=Math.max((e-h)/(2*Math.PI)*s,1);for(let t=0;t<o;t++){var a=h+(e-h)*t/o,l=this.p.x+Math.cos(a)*this.r,a=this.p.y+Math.sin(a)*this.r;i.push(new g(l,a))}}}return new w(i)}}s.Cell=y},{}],4:[function(t,e,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[s]}})}:function(t,e,s,i){t[i=void 0===i?s:i]=e[s]}),n=this&&this.__exportStar||function(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||i(e,t,s)};Object.defineProperty(s,"__esModule",{value:!0}),n(t("./math"),s),n(t("./geometry"),s),n(t("./physics"),s),n(t("./evolution"),s),n(t("./audio"),s),n(t("./visual"),s)},{"./audio":1,"./evolution":2,"./geometry":3,"./math":5,"./physics":6,"./visual":7}],5:[function(t,e,s){"use strict";function i(t){return t.reduce((t,e)=>t+e)}function n(t){return i(t)/t.length}function r(e){var s=n(e);let i=0;for(let t=0;t<e.length;t++)i+=(e[t]-s)*(e[t]-s);return i/e.length}Object.defineProperty(s,"__esModule",{value:!0}),s.Perlin=s.Random=s.deviation=s.variance=s.median=s.mean=s.sum=s.min=s.max=s.dist=s.norm=s.map=s.lerp=s.clamp=s.fract=s.rad=s.deg=void 0,s.deg=function(t){return t/Math.PI*180},s.rad=function(t){return t/180*Math.PI},s.fract=function(t){return t-Math.floor(t)},s.clamp=function(t,e,s){return Math.max(e,Math.min(t,s))},s.lerp=function(t,e,s){return t+(e-t)*s},s.map=function(t,e,s,i,n){return i+(n-i)*(t-e)/(s-e)},s.norm=function(t,e,s){return(t-e)/(s-e)},s.dist=function(t,e,s,i){return s=t-s,i=e-i,Math.sqrt(s*s+i*i)},s.max=function(t){return Math.max(...t)},s.min=function(t){return Math.min(...t)},s.sum=i,s.mean=n,s.median=function(t){var e=[...t].sort(),s=Math.floor(t.length/2);return t.length%2==0?(e[s-1]+e[s])/2:e[s]},s.variance=r,s.deviation=function(t){return Math.sqrt(r(t))};class h{constructor(){this._a=1664525,this._c=1013904223,this._m=4294967296}seed(t){this._seed=t}lcg(){return this._seed=(this._a*this._seed+this._c)%this._m,this._seed/this._m}next(){let t;return t=null==this._seed?Math.random():this.lcg(),1==arguments.length?arguments[0]*t:2==arguments.length?arguments[0]+(arguments[1]-arguments[0])*t:t}}s.Random=h;s.Perlin=class{constructor(){this._random=new h,this._offset=256*Math.random(),this._gradient=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.permutation(),this._octaves=4,this._falloff=.5}permutation(){let e=new Array(256);for(let t=0;t<256;t++)e[t]=t;let s=[];for(;e.length;){var t=Math.floor(this._random.next(e.length));s.push(e.splice(t,1)[0])}this._permutation=new Array(512);for(let t=0;t<512;t++)this._permutation[t]=s[255&t]}seed(t){this._random.seed(t),this._offset=256*this._random.next(),this.permutation()}detail(t,e){this._octaves=t,this._falloff=e}noise(e,s=0,i=0){e+=this._offset;let n=0,r=1,h=1,o=0;for(let t=0;t<this._octaves;t++)n+=this.compute(e*r,s*r,i*r)*h,r*=2,o+=h,h*=this._falloff;return n/o}dot(t,e,s,i){return t[0]*e+t[1]*s+t[2]*i}fade(t){return t*t*t*(t*(6*t-15)+10)}mix(t,e,s){return(1-s)*t+s*e}compute(t,e=0,s=0){var i=Math.floor(t),n=Math.floor(e),r=Math.floor(s);t-=i,e-=n,s-=r;var h=11&this._permutation[(i&=255)+this._permutation[(n&=255)+this._permutation[r&=255]]],o=11&this._permutation[i+this._permutation[n+this._permutation[1+r]]],a=11&this._permutation[i+this._permutation[1+n+this._permutation[r]]],l=11&this._permutation[i+this._permutation[1+n+this._permutation[1+r]]],c=11&this._permutation[1+i+this._permutation[n+this._permutation[r]]],p=11&this._permutation[1+i+this._permutation[n+this._permutation[1+r]]],u=11&this._permutation[1+i+this._permutation[1+n+this._permutation[r]]],r=11&this._permutation[1+i+this._permutation[1+n+this._permutation[1+r]]],h=this.dot(this._gradient[h],t,e,s),c=this.dot(this._gradient[c],t-1,e,s),a=this.dot(this._gradient[a],t,e-1,s),u=this.dot(this._gradient[u],t-1,e-1,s),o=this.dot(this._gradient[o],t,e,s-1),p=this.dot(this._gradient[p],t-1,e,s-1),l=this.dot(this._gradient[l],t,e-1,s-1),r=this.dot(this._gradient[r],t-1,e-1,s-1),t=this.fade(t),e=this.fade(e),s=this.fade(s),c=this.mix(h,c,t),p=this.mix(o,p,t),u=this.mix(a,u,t),t=this.mix(l,r,t),u=this.mix(c,u,e),e=this.mix(p,t,e);return(this.mix(u,e,s)+1)/2}}},{}],6:[function(t,e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.PolygonConstraint=s.RectConstraint=s.CircleConstraint=s.Constraint=s.Gravitation=s.Collision=s.InteractionForce=s.CircleField=s.ArcField=s.LineField=s.PointField=s.ConstForce=s.Force=s.Spring=s.Particle=s.World=void 0;const l=t("./geometry");s.World=class{constructor(t=null){this.friction=.75,this.bounds=t,this.particles=[],this.springs=[],this.forces=[],this.interactionForces=[],this.constraints=[]}addParticle(t){this.particles.push(t)}addSpring(t){this.springs.push(t)}addForce(t){this.forces.push(t)}addInteractionForce(t){this.interactionForces.push(t)}addConstraint(t){this.constraints.push(t)}removeParticle(t){t=this.particles.indexOf(t);-1!=t&&this.particles.splice(t,1)}removeSpring(t){t=this.springs.indexOf(t);-1!=t&&this.springs.splice(t,1)}removeForce(t){t=this.forces.indexOf(t);-1!=t&&this.forces.splice(t,1)}removeInteractionForce(t){t=this.interactionForces.indexOf(t);-1!=t&&this.interactionForces.splice(t,1)}removeConstraint(t){t=this.constraints.indexOf(t);-1!=t&&this.constraints.splice(t,1)}update(){for(var t of this.particles)for(var e of this.forces)e.apply(t);for(var s of this.interactionForces)s.apply(this.particles);for(var i of this.springs)i.update();for(var n of this.particles)n.update(this.friction);for(var r of this.particles)for(var h of this.constraints)h.apply(r);if(this.bounds)for(var o of this.particles)o.bounce(this.bounds)}};s.Particle=class{constructor(t,e){this.radius=1,this.mass=1,this.position=new l.Vector(t,e),this.previousPosition=this.position.copy(),this._force=new l.Vector}velocity(){return this.position.sub(this.previousPosition)}addVelocity(t){this._fix||(this.previousPosition=this.previousPosition.sub(t))}clearVelocity(){this.previousPosition=this.position.copy()}addForce(t){this._fix||(this._force=this._force.add(t))}clearForce(){this._force=new l.Vector}update(e=1){if(!this._fix){let t=this.position.sub(this.previousPosition);e=this.position.add(t.add(this._force.div(this.mass)).mult(e));this.previousPosition=this.position.copy(),this.position=e,this._force=this._force.mult(0)}}bounce(t){this._fix||(this.position.x=Math.min(Math.max(this.position.x,t.p.x+this.radius),t.p.x+t.w-this.radius),this.position.y=Math.min(Math.max(this.position.y,t.p.y+this.radius),t.p.y+t.h-this.radius))}bounds(){return new l.Circle(this.position.x,this.position.y,this.radius)}fix(){this._fix=!0}unfix(){this._fix=!1}};s.Spring=class{constructor(){this.strength=1,this._min=0,this._max=Number.POSITIVE_INFINITY,this.p1=arguments[0],this.p2=arguments[1],2==arguments.length?this.length=this.p1.position.sub(this.p2.position).mag():3==arguments.length?(this.length=this.p1.position.sub(this.p2.position).mag(),this.strength=arguments[2]):4==arguments.length&&(this.strength=arguments[2],this.length=arguments[3])}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}update(){let t=this.p1.position.sub(this.p2.position);var e=t.mag();e>=this._min&&e<=this._max&&(t=t.mult((this.length-e)/e/(this.p1.mass+this.p2.mass)*this.strength),this.p1.position=this.p1.position.add(t.mult(this.p1.mass)),this.p2.position=this.p2.position.sub(t.mult(this.p2.mass)))}};class i{}(class extends(s.Force=i){});s.ConstForce=class extends i{constructor(){super(),this.force=1==arguments.length?arguments[0]:2==arguments.length?new l.Vector(arguments[0],arguments[1]):new l.Vector(0,0)}apply(t){t.addForce(this.force)}};s.PointField=class extends i{constructor(t,e=1){super(),this._min=0,this._max=Number.POSITIVE_INFINITY,this.point=t,this.strength=e}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}force(t){let e=t.sub(this.point.x,this.point.y);var s=e.mag();if(s>=this._min&&s<=this._max){t=s-this._min,s=this._max-this._min;return e=e.normalize().mult(1-t*t/(s*s)),e.mult(-this.strength)}return null}apply(t){var e=this.force(t.position);e&&t.addForce(e)}};s.LineField=class extends i{constructor(t,e=1){super(),this._min=0,this._max=Number.POSITIVE_INFINITY,this.line=t,this.strength=e}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}force(t){var e=this.line.closest(new l.Point(t.x,t.y));let s=t.sub(e.x,e.y);t=s.mag();if(t>=this._min&&t<=this._max){e=t-this._min,t=this._max-this._min;return s=s.normalize().mult(1-e*e/(t*t)),s.mult(-this.strength)}return null}apply(t){var e=this.force(t.position);e&&t.addForce(e)}};s.ArcField=class extends i{constructor(t,e=1){super(),this._min=0,this._max=Number.POSITIVE_INFINITY,this.arc=t,this.strength=e}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}force(t){var e=this.arc.closest(new l.Point(t.x,t.y));let s=t.sub(e.x,e.y);t=s.mag();if(t>=this._min&&t<=this._max){e=t-this._min,t=this._max-this._min;return s=s.normalize().mult(1-e*e/(t*t)),s.mult(-this.strength)}return null}apply(t){var e=this.force(t.position);e&&t.addForce(e)}};s.CircleField=class extends i{constructor(t,e=1){super(),this._min=0,this._max=Number.POSITIVE_INFINITY,this.circle=t,this.strength=e}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}force(t){var e=this.circle.closest(new l.Point(t.x,t.y));let s=t.sub(e.x,e.y);t=s.mag();if(t>=this._min&&t<=this._max){e=t-this._min,t=this._max-this._min;return s=s.normalize().mult(1-e*e/(t*t)),s.mult(-this.strength)}return null}apply(t){var e=this.force(t.position);e&&t.addForce(e)}};class n{}(class extends(s.InteractionForce=n){});s.Collision=class extends n{constructor(t=null){super(),this.strength=1,this.iterations=1,this._filter=()=>!0,this._quadTree=t}filter(t){this._filter=t}apply(i){for(let t=0;t<this.iterations;t++){this._quadTree&&(this._quadTree.clear(),this._quadTree.insert(i));for(let e=0;e<i.length-1;e++){let s=i[e];if(this._quadTree){var n=this._quadTree.query(new l.Circle(s.position.x,s.position.y,s.radius));for(let t=0;t<n.length;t++){let e=n[t];if(this._filter(s,e)&&s!==e){let t=s.position.sub(e.position);var r=t.mag(),h=s.radius+e.radius;r<h&&(t=t.normalize().mult(h-r).mult(this.strength),s.position=s.position.add(t.mult(s.radius/h)),e.position=e.position.sub(t.mult(e.radius/h)))}}}else for(let t=e+1;t<i.length;t++){let e=i[t];if(this._filter(s,e)){let t=s.position.sub(e.position);var o=t.mag(),a=s.radius+e.radius;o<a&&(t=t.normalize().mult(a-o).mult(this.strength),s.position=s.position.add(t.mult(s.radius/a)),e.position=e.position.sub(t.mult(e.radius/a)))}}}}}};s.Gravitation=class extends n{constructor(t=1){super(),this.iterations=1,this._min=0,this._max=Number.POSITIVE_INFINITY,this.G=t,this._filter=()=>!0}range(t=0,e=Number.POSITIVE_INFINITY){this._min=t,this._max=e}filter(t){this._filter=t}apply(i){for(let t=0;t<this.iterations;t++)for(let e=0;e<i.length-1;e++){let s=i[e];for(let t=e+1;t<i.length;t++){let e=i[t];if(this._filter(s,e)){let t=s.position.sub(e.position);var n=t.mag();n>=this._min&&n<=this._max&&(t=t.normalize().mult(this.G*s.mass*e.mass/(n*n)),s.position=s.position.sub(t),e.position=e.position.add(t))}}}}};class r{}(class extends(s.Constraint=r){});s.CircleConstraint=class extends r{constructor(t){super(),this.circle=t}apply(e){if(this.circle.p.distance(new l.Point(e.position.x,e.position.y))<this.circle.r+e.radius){let t=e.position.sub(this.circle.p.x,this.circle.p.y).normalize();t=t.mult(this.circle.r+e.radius).add(this.circle.p.x,this.circle.p.y),e.position.x=t.x,e.position.y=t.y}}};s.RectConstraint=class extends r{constructor(t){super(),this.rect=t}apply(e){let s=e.position.x,i=e.position.y,n=!1,r=!1;s<this.rect.p.x?s=this.rect.p.x:s>this.rect.p.x+this.rect.w?s=this.rect.p.x+this.rect.w:n=!0,i<this.rect.p.y?i=this.rect.p.y:i>this.rect.p.y+this.rect.h?i=this.rect.p.y+this.rect.h:r=!0;var t=e.position.x-s,h=e.position.y-i;if(t*t+h*h<=e.radius*e.radius){let t=e.position.sub(s,i).normalize().mult(e.radius).add(s,i);n&&r&&(t=t.invert()),e.position.x=t.x,e.position.y=t.y}}};s.PolygonConstraint=class extends r{constructor(t){super(),this.polygon=t}apply(e){var t=new l.Point(e.position.x,e.position.y),s=this.polygon.contains(t);let i=this.polygon.closest(t);t=i.distance(t);if(s||t<e.radius){let t=e.position.sub(i.x,i.y).normalize().mult(e.radius).add(i.x,i.y);s&&(t=t.invert()),e.position.x=t.x,e.position.y=t.y}}}},{"./geometry":3}],7:[function(t,e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Color=s.Renderer=void 0;const h=t("./geometry");s.Renderer=class{constructor(t){this.frameCount=0,this.mouse={px:0,py:0,x:0,y:0,press:!1,over:!1,out:!1,move:!1,down:!1,up:!1,click:!1,dblclick:!1},this._loop=!0,this._stroke=!0,this._fill=!0,this._font={style:"normal",weight:"normal",size:12,family:"sans-serif"},this.canvas=t,this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this._mouseover=this.mouseover.bind(this),this._mouseout=this.mouseout.bind(this),this._mousemove=this.mousemove.bind(this),this._mousedown=this.mousedown.bind(this),this._mouseup=this.mouseup.bind(this),this._click=this.click.bind(this),this._dblclick=this.dblclick.bind(this),this.onMouse()}size(t,e){this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e}background(t){this.canvas.style.background=t}on(t,e,s=!1){this.canvas.addEventListener(t,e,s)}off(t,e){this.canvas.removeEventListener(t,e)}onMouse(t=!0){t?(this.canvas.addEventListener("mouseover",this._mouseover.bind(this),!1),this.canvas.addEventListener("mouseout",this._mouseout.bind(this),!1),this.canvas.addEventListener("mousemove",this._mousemove.bind(this),!1),this.canvas.addEventListener("mousedown",this._mousedown.bind(this),!1),this.canvas.addEventListener("mouseup",this._mouseup.bind(this),!1),this.canvas.addEventListener("click",this._click.bind(this),!1),this.canvas.addEventListener("dblclick",this._dblclick.bind(this),!1)):(this.canvas.removeEventListener("mouseover",this._mouseover.bind(this),!1),this.canvas.removeEventListener("mouseout",this._mouseout.bind(this),!1),this.canvas.removeEventListener("mousemove",this._mousemove.bind(this),!1),this.canvas.removeEventListener("mousedown",this._mousedown.bind(this),!1),this.canvas.removeEventListener("mouseup",this._mouseup.bind(this),!1),this.canvas.removeEventListener("click",this._click.bind(this),!1),this.canvas.removeEventListener("dblclick",this._dblclick.bind(this),!1))}mouseover(t){this.mouse.over=!0}mouseout(t){this.mouse.out=!0}mousemove(t){this.mouse.move=!0,this.mouse.px=this.mouse.x,this.mouse.py=this.mouse.y,this.mouse.x=t.offsetX,this.mouse.y=t.offsetY}mousedown(t){this.mouse.down=!0,this.mouse.press=!0}mouseup(t){this.mouse.up=!0,this.mouse.press=!1}click(t){this.mouse.click=!0}dblclick(t){this.mouse.dblclick=!0}draw(t){this._draw=t,this.animation()}loop(t=!0){t?this._loop||(this._loop=!0,this.animation()):this._loop=!1}animation(){this.context.setTransform(1,0,0,1,0,0),this._draw(),this.mouse.over=!1,this.mouse.out=!1,this.mouse.move=!1,this.mouse.down=!1,this.mouse.up=!1,this.mouse.click=!1,this.mouse.dblclick=!1,this.frameCount++,this._loop&&window.requestAnimationFrame(this.animation.bind(this))}alpha(t){this.context.globalAlpha=t}clear(){var t;this.context.setTransform(1,0,0,1,0,0),1==arguments.length?(t=this.context.fillStyle,this.context.fillStyle=arguments[0],this.context.fillRect(0,0,this.width,this.height),this.context.fillStyle=t):this.context.clearRect(0,0,this.width,this.height)}stroke(t=!0){"boolean"==typeof t?this._stroke=t:(this._stroke=!0,this.context.strokeStyle=t)}lineWidth(t){this.context.lineWidth=t}lineCap(t){this.context.lineCap=t}lineJoin(t){this.context.lineJoin=t}lineDash(t){"boolean"==typeof t?this.context.setLineDash([]):this.context.setLineDash(t)}dashOffset(t){this.context.lineDashOffset=t}fill(t=!0){"boolean"==typeof t?this._fill=t:(this._fill=!0,this.context.fillStyle=t)}point(){if(this._stroke){let t,e;if(arguments[0]instanceof h.Point)[t,e]=[arguments[0].x,arguments[0].y];else{if(2!=arguments.length)return;[t,e]=[arguments[0],arguments[1]]}var s=this.context.fillStyle;this.context.fillStyle=this.context.strokeStyle,this.context.beginPath(),this.context.arc(t,e,.5*this.context.lineWidth,0,2*Math.PI,!1),this.context.fill(),this.context.fillStyle=s}}line(){if(this._stroke){let t,e,s,i;if(arguments[0]instanceof h.Line)[t,e,s,i]=[arguments[0].p1.x,arguments[0].p1.y,arguments[0].p2.x,arguments[0].p2.y];else if(2==arguments.length)[t,e,s,i]=[arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y];else{if(4!=arguments.length)return;[t,e,s,i]=[arguments[0],arguments[1],arguments[2],arguments[3]]}this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(s,i),this.context.stroke()}}arc(){if(this._stroke||this._fill){let t,e,s,i,n;if(arguments[0]instanceof h.Arc)[t,e,s,i,n]=[arguments[0].p.x,arguments[0].p.y,arguments[0].r,arguments[0].start,arguments[0].end];else{if(4!=arguments.length)return;[t,e,s,i,n]=[arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]]}this.context.beginPath(),this.context.arc(t,e,s,i,n,!1),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}polyline(){if(this._stroke){let t;if(arguments[0]instanceof h.Polyline)t=arguments[0].vertices;else{if(!(arguments[0]instanceof Array))return;t=arguments[0]}this.context.beginPath();for(var e of t)this.context.lineTo(e.x,e.y);this.context.stroke()}}spline(t,e="clamped",s=20){(t=t instanceof Array?new h.Spline(t):t).compute(e,s),this.polyline(t.vertices)}sector(){if(this._stroke||this._fill){let t,e,s,i,n,r;if(arguments[0]instanceof h.Sector)[t,e,s,i,n,r]=[arguments[0].p.x,arguments[0].p.y,arguments[0].r1,arguments[0].r2,arguments[0].start,arguments[0].end];else{if(4!=arguments.length)return;[t,e,s,i,n,r]=[arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]]}this.context.beginPath(),this.context.arc(t,e,i,n,r,!1),0==s?this.context.lineTo(t,e):this.context.arc(t,e,s,r,n,!0),this.context.closePath(),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}circle(){if(this._stroke||this._fill){let t,e,s;if(arguments[0]instanceof h.Circle)[t,e,s]=[arguments[0].p.x,arguments[0].p.y,arguments[0].r];else{if(3!=arguments.length)return;[t,e,s]=[arguments[0],arguments[1],arguments[2]]}this.context.beginPath(),this.context.arc(t,e,s,0,2*Math.PI,!1),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}ellipse(t,e,s,i,n=0){(this._stroke||this._fill)&&(this.context.beginPath(),this.context.ellipse(t,e,s,i,n,0,2*Math.PI,!1),this._fill&&this.context.fill(),this._stroke&&this.context.stroke())}triangle(){if(this._stroke||this._fill){let t,e,s,i,n,r;if(arguments[0]instanceof h.Triangle)[t,e,s,i,n,r]=[arguments[0].p1.x,arguments[0].p1.y,arguments[0].p2.x,arguments[0].p2.y,arguments[0].p3.x,arguments[0].p3.y];else if(3==arguments.length)[t,e,s,i,n,r]=[arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y,arguments[2].x,arguments[2].y];else{if(6!=arguments.length)return;[t,e,s,i,n,r]=[arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]]}this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(s,i),this.context.lineTo(n,r),this.context.closePath(),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}rect(){if(this._stroke||this._fill){let t,e,s,i;if(arguments[0]instanceof h.Rect)[t,e,s,i]=[arguments[0].p.x,arguments[0].p.y,arguments[0].w,arguments[0].h];else{if(4!=arguments.length)return;[t,e,s,i]=[arguments[0],arguments[1],arguments[2],arguments[3]]}this._fill&&this.context.fillRect(t,e,s,i),this._stroke&&this.context.strokeRect(t,e,s,i)}}quad(){if(this._stroke||this._fill){let t,e,s,i,n,r,h,o;if(4==arguments.length)[t,e,s,i,n,r,h,o]=[arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y,arguments[2].x,arguments[2].y,arguments[3].x,arguments[3].y];else{if(8!=arguments.length)return;[t,e,s,i,n,r,h,o]=[arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]]}this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(s,i),this.context.lineTo(n,r),this.context.lineTo(h,o),this.context.closePath(),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}polygon(){if(this._stroke||this._fill){let t;if(arguments[0]instanceof h.Polygon)t=arguments[0].vertices;else{if(!(arguments[0]instanceof Array))return;t=arguments[0]}this.context.beginPath();for(var e of t)this.context.lineTo(e.x,e.y);this.context.closePath(),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}}cell(e){if(this._stroke||this._fill)if(1==e.state){this.context.beginPath(),this.context.moveTo(e.vertices[0].x,e.vertices[0].y);for(let t=0;t<e.vertices.length;t++){var s=e.vertices[t],i=e.vertices[(t+1)%e.vertices.length];0==s.type?this.context.lineTo(i.x,i.y):this.context.arc(e.p.x,e.p.y,e.r,s.a,i.a)}this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}else this.circle(e.p.x,e.p.y,e.r)}quadraticBezier(t,e,s,i,n,r){(this._stroke||this._fill)&&(this.context.beginPath(),this.context.moveTo(t,e),this.context.quadraticCurveTo(s,i,n,r),this.context.quadraticCurveTo(s,i,n,r),this._fill&&this.context.fill(),this._stroke&&this.context.stroke())}bezier(t,e,s,i,n,r,h,o){(this._stroke||this._fill)&&(this.context.beginPath(),this.context.moveTo(t,e),this.context.bezierCurveTo(s,i,n,r,h,o),this._fill&&this.context.fill(),this._stroke&&this.context.stroke())}beginPath(){this.context.beginPath()}moveTo(t,e){this.context.moveTo(t,e)}lineTo(t,e){this.context.lineTo(t,e)}quadraticBezierTo(t,e,s,i){this.context.quadraticCurveTo(t,e,s,i)}bezierTo(t,e,s,i,n,r){this.context.bezierCurveTo(t,e,s,i,n,r)}endPath(t=!1){t&&this.context.closePath(),this._fill&&this.context.fill(),this._stroke&&this.context.stroke()}fontStyle(t){this._font.style=t,this.font()}fontWeight(t){this._font.weight=t,this.font()}fontSize(t){this._font.size=t,this.font()}fontFamily(t){this._font.family=t,this.font()}font(){this.context.font=this._font.style+" "+this._font.weight+" "+this._font.size+"px "+this._font.family}textAlign(t){this.context.textAlign=t}textBaseline(t){this.context.textBaseline=t}measureText(t){return this.context.measureText(t).width}text(t,e,s){this._fill&&this.context.fillText(t,e,s),this._stroke&&this.context.strokeText(t,e,s)}save(){this.context.save()}restore(){this.context.restore()}translate(t,e){this.context.translate(t,e)}rotate(t){this.context.rotate(t)}scale(t,e){this.context.scale(t,e)}setTransform(t,e,s,i,n,r){this.context.setTransform(t,e,s,i,n,r)}transform(t,e,s,i,n,r){this.context.transform(t,e,s,i,n,r)}image(t,e,s,i,n){this.context.drawImage(t,e,s,i,n)}dataURL(){return this.canvas.toDataURL()}};s.Color=class{static rgb(){return 1==arguments.length?"rgb("+arguments[0]+","+arguments[0]+","+arguments[0]+")":2==arguments.length?"rgba("+arguments[0]+","+arguments[0]+","+arguments[0]+","+arguments[1]+")":3==arguments.length?"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":4==arguments.length?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":void 0}static hsl(){return 1==arguments.length?"hsl(0,0%,"+arguments[0]+"%)":2==arguments.length?"hsla(0,0%,"+arguments[0]+"%,"+arguments[1]+")":3==arguments.length?"hsl("+arguments[0]+","+arguments[1]+"%,"+arguments[2]+"%)":4==arguments.length?"hsla("+arguments[0]+","+arguments[1]+"%,"+arguments[2]+"%,"+arguments[3]+")":void 0}static lerp(t,e,s){var i=t.slice(0,3),n="\\((.+?)\\)";let r=t.match(n)[1].split(","),h=e.match(n)[1].split(",");var o=r.length;"hsl"==i&&(r[1]=r[1].slice(0,-1),r[2]=r[2].slice(0,-1),h[1]=h[1].slice(0,-1),h[2]=h[2].slice(0,-1));t=Number(r[0])+(Number(h[0])-Number(r[0]))*s,e=Number(r[1])+(Number(h[1])-Number(r[1]))*s,n=Number(r[2])+(Number(h[2])-Number(r[2]))*s;let a=1;return 4==o&&(a=Number(r[3])+(Number(h[3])-Number(r[3]))*s),"rgb"==i?`rgba(${t},${e},${n},${a})`:"hsl"==i?`hsla(${t},${e}%,${n}%,${a})`:void 0}}},{"./geometry":3}]},{},[4])(4)});